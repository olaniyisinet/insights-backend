"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.InsightsBackendStack = void 0;
const aws_cdk_lib_1 = require("aws-cdk-lib");
const construct_dynamodb_user_1 = require("./construct-dynamodb-user");
const construct_dynamodb_tenant_1 = require("./construct-dynamodb-tenant");
const construct_lambda_api_1 = require("./construct-lambda-api");
const construct_cognito_pool_1 = require("./construct-cognito-pool");
class InsightsBackendStack extends aws_cdk_lib_1.Stack {
    constructor(scope, id, buildConfig, props) {
        super(scope, id, props);
        // create database schema
        const dynamoUsersTable = new construct_dynamodb_user_1.DynamoUserTable(this, "UserTable", buildConfig);
        const dynamoTenantTable = new construct_dynamodb_tenant_1.DynamoTenantTable(this, "TenantTable", buildConfig);
        // create the cognito user pool
        const coginitoUserPool = new construct_cognito_pool_1.CognitoUserPool(this, buildConfig);
        // create the api end point
        const lambdaApi = new construct_lambda_api_1.LambdaApi(this, buildConfig, {
            userPool: coginitoUserPool,
            dynamoUsersTable: dynamoUsersTable,
            dynamoTenantTable: dynamoTenantTable,
        });
    }
}
exports.InsightsBackendStack = InsightsBackendStack;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5zaWdodHMtYmFja2VuZC1zdGFjay5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImluc2lnaHRzLWJhY2tlbmQtc3RhY2sudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsNkNBQStEO0FBSS9ELHVFQUE0RDtBQUM1RCwyRUFBZ0U7QUFDaEUsaUVBQW1EO0FBQ25ELHFFQUEwRDtBQUUxRCxNQUFhLG9CQUFxQixTQUFRLG1CQUFLO0lBQzdDLFlBQWEsS0FBZ0IsRUFBRSxFQUFVLEVBQUUsV0FBd0IsRUFBRSxLQUFrQjtRQUNyRixLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUV4Qix5QkFBeUI7UUFDekIsTUFBTSxnQkFBZ0IsR0FBRyxJQUFJLHlDQUFlLENBQUMsSUFBSSxFQUFFLFdBQVcsRUFBRSxXQUFXLENBQUMsQ0FBQztRQUM3RSxNQUFNLGlCQUFpQixHQUFHLElBQUksNkNBQWlCLENBQUMsSUFBSSxFQUFFLGFBQWEsRUFBRSxXQUFXLENBQUMsQ0FBQztRQUVsRiwrQkFBK0I7UUFDL0IsTUFBTSxnQkFBZ0IsR0FBRyxJQUFJLHdDQUFlLENBQUMsSUFBSSxFQUFFLFdBQVcsQ0FBQyxDQUFDO1FBRWhFLDJCQUEyQjtRQUMzQixNQUFNLFNBQVMsR0FBRyxJQUFJLGdDQUFTLENBQUMsSUFBSSxFQUFFLFdBQVcsRUFBRTtZQUNqRCxRQUFRLEVBQUUsZ0JBQWdCO1lBQzFCLGdCQUFnQixFQUFFLGdCQUFnQjtZQUNsQyxpQkFBaUIsRUFBRSxpQkFBaUI7U0FDckMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztDQUNGO0FBbEJELG9EQWtCQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFN0YWNrLCBTdGFja1Byb3BzLCBSZW1vdmFsUG9saWN5IH0gZnJvbSAnYXdzLWNkay1saWInO1xuaW1wb3J0ICogYXMgczMgZnJvbSAnYXdzLWNkay1saWIvYXdzLXMzJztcbmltcG9ydCB7IENvbnN0cnVjdCB9IGZyb20gJ2NvbnN0cnVjdHMnO1xuaW1wb3J0IHsgQnVpbGRDb25maWcgfSBmcm9tICcuL2J1aWxkLWNvbmZpZyc7XG5pbXBvcnQgeyBEeW5hbW9Vc2VyVGFibGUgfSBmcm9tICcuL2NvbnN0cnVjdC1keW5hbW9kYi11c2VyJztcbmltcG9ydCB7IER5bmFtb1RlbmFudFRhYmxlIH0gZnJvbSAnLi9jb25zdHJ1Y3QtZHluYW1vZGItdGVuYW50JztcbmltcG9ydCB7IExhbWJkYUFwaSB9IGZyb20gXCIuL2NvbnN0cnVjdC1sYW1iZGEtYXBpXCI7XG5pbXBvcnQge0NvZ25pdG9Vc2VyUG9vbCB9IGZyb20gJy4vY29uc3RydWN0LWNvZ25pdG8tcG9vbCc7XG5cbmV4cG9ydCBjbGFzcyBJbnNpZ2h0c0JhY2tlbmRTdGFjayBleHRlbmRzIFN0YWNrIHtcbiAgY29uc3RydWN0b3IoIHNjb3BlOiBDb25zdHJ1Y3QsIGlkOiBzdHJpbmcsIGJ1aWxkQ29uZmlnOiBCdWlsZENvbmZpZywgcHJvcHM/OiBTdGFja1Byb3BzKSB7XG4gICAgc3VwZXIoc2NvcGUsIGlkLCBwcm9wcyk7XG5cbiAgICAvLyBjcmVhdGUgZGF0YWJhc2Ugc2NoZW1hXG4gICAgY29uc3QgZHluYW1vVXNlcnNUYWJsZSA9IG5ldyBEeW5hbW9Vc2VyVGFibGUodGhpcywgXCJVc2VyVGFibGVcIiwgYnVpbGRDb25maWcpO1xuICAgIGNvbnN0IGR5bmFtb1RlbmFudFRhYmxlID0gbmV3IER5bmFtb1RlbmFudFRhYmxlKHRoaXMsIFwiVGVuYW50VGFibGVcIiwgYnVpbGRDb25maWcpO1xuXG4gICAgLy8gY3JlYXRlIHRoZSBjb2duaXRvIHVzZXIgcG9vbFxuICAgIGNvbnN0IGNvZ2luaXRvVXNlclBvb2wgPSBuZXcgQ29nbml0b1VzZXJQb29sKHRoaXMsIGJ1aWxkQ29uZmlnKTtcblxuICAgIC8vIGNyZWF0ZSB0aGUgYXBpIGVuZCBwb2ludFxuICAgIGNvbnN0IGxhbWJkYUFwaSA9IG5ldyBMYW1iZGFBcGkodGhpcywgYnVpbGRDb25maWcsIHtcbiAgICAgIHVzZXJQb29sOiBjb2dpbml0b1VzZXJQb29sLFxuICAgICAgZHluYW1vVXNlcnNUYWJsZTogZHluYW1vVXNlcnNUYWJsZSxcbiAgICAgIGR5bmFtb1RlbmFudFRhYmxlOiBkeW5hbW9UZW5hbnRUYWJsZSxcbiAgICB9KTtcbiAgfVxufVxuIl19